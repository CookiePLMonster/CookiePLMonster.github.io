{%- if include.thumbnail == 'auto' -%}
    {%- assign thumbnail-path = include.link | split: '/' -%}
    {%- assign thumbnail-file = thumbnail-path | last | replace: '.png', '.jpg' -%}
    {%- assign thumbnail = thumbnail-path | pop | push: 'thumb' | push: thumbnail-file | join: '/' -%}
{%- else -%}
    {%- assign thumbnail = include.thumbnail | default: include.link -%}
{%- endif -%}
<figure class="{{ 'fig-entry' | append: ' ' | append: include.style | strip }}" id="{{ include.id }}">
    {%- if include.link -%}<a href="{% link {{ include.link }} %}" target="_blank">{%- endif -%}
    <img src="{% link {{ thumbnail }} %}" alt="" {% unless jekyll.environment == "development" %}{% imagesize thumbnail:props %}{% endunless %}>
    {%- if include.link -%}</a>{%- endif -%}
    {%- if include.caption -%}<figcaption markdown="span">{{ include.caption }}</figcaption>{%- endif -%}
</figure>
